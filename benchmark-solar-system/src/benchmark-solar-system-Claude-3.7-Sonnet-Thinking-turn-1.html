<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Animation</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background-color: #000;
        }

        canvas {
            display: block;
        }
    </style>
</head>

<body>
    <canvas id="solarSystem"></canvas>

    <script>
        // Solar System Animation
        (function () {
            // Canvas setup
            const canvas = document.getElementById('solarSystem');
            const ctx = canvas.getContext('2d');

            // Make canvas fullscreen
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            // Create offscreen canvas for static elements (orbit paths)
            let offscreenCanvas = document.createElement('canvas');
            offscreenCanvas.width = canvas.width;
            offscreenCanvas.height = canvas.height;
            let offscreenCtx = offscreenCanvas.getContext('2d');

            // Center of the canvas (sun position)
            let centerX = canvas.width / 2;
            let centerY = canvas.height / 2;

            // Scale factor to fit all planets on screen
            let scale = Math.min(canvas.width, canvas.height) / 90;

            // Planet data
            const planets = [
                {
                    name: "Sun",
                    baseRadius: 5,
                    radius: 5 * scale,
                    baseDistance: 0,
                    distance: 0,
                    orbitPeriod: 0,
                    angle: 0,
                    colors: ["#f2831f", "#f15d22", "#d94125", "#a41d22"]
                },
                {
                    name: "Mercury",
                    baseRadius: 0.4,
                    radius: 0.4 * scale,
                    baseDistance: 8,
                    distance: 8 * scale,
                    orbitPeriod: 88, // days
                    angle: 0,
                    colors: ["#5a5856", "#bfbdbc", "#8c8a89", "#f4f6f8"]
                },
                {
                    name: "Venus",
                    baseRadius: 0.9,
                    radius: 0.9 * scale,
                    baseDistance: 11,
                    distance: 11 * scale,
                    orbitPeriod: 225, // days
                    angle: 0,
                    colors: ["#868a8d", "#d9b392", "#f3dbc3", "#414141"]
                },
                {
                    name: "Earth",
                    baseRadius: 1,
                    radius: 1 * scale,
                    baseDistance: 14,
                    distance: 14 * scale,
                    orbitPeriod: 365, // days
                    angle: 0,
                    colors: ["#1f386f", "#0b1725", "#386f61", "#dac0a5"]
                },
                {
                    name: "Mars",
                    baseRadius: 0.5,
                    radius: 0.5 * scale,
                    baseDistance: 17,
                    distance: 17 * scale,
                    orbitPeriod: 687, // days
                    angle: 0,
                    colors: ["#dabd9e", "#8c5d4b", "#f27c5f", "#c36d5c"]
                },
                {
                    name: "Jupiter",
                    baseRadius: 2.5,
                    radius: 2.5 * scale,
                    baseDistance: 22,
                    distance: 22 * scale,
                    orbitPeriod: 4333, // days
                    angle: 0,
                    colors: ["#282411", "#c08137", "#bfb09c", "#a6705b"]
                },
                {
                    name: "Saturn",
                    baseRadius: 2.1,
                    radius: 2.1 * scale,
                    baseDistance: 27,
                    distance: 27 * scale,
                    orbitPeriod: 10759, // days
                    angle: 0,
                    colors: ["#f3cf89", "#dab778", "#736b59", "#c1a480"]
                },
                {
                    name: "Uranus",
                    baseRadius: 1.7,
                    radius: 1.7 * scale,
                    baseDistance: 32,
                    distance: 32 * scale,
                    orbitPeriod: 30687, // days
                    angle: 0,
                    colors: ["#3f575a", "#688a8c", "#95bbbe", "#cfecf0"]
                },
                {
                    name: "Neptune",
                    baseRadius: 1.6,
                    radius: 1.6 * scale,
                    baseDistance: 37,
                    distance: 37 * scale,
                    orbitPeriod: 60190, // days
                    angle: 0,
                    colors: ["#647ba5", "#7595bf", "#4e5d73", "#789ebf"]
                },
                {
                    name: "Pluto",
                    baseRadius: 0.2,
                    radius: 0.2 * scale,
                    baseDistance: 42,
                    distance: 42 * scale,
                    orbitPeriod: 90560, // days
                    angle: 0,
                    colors: ["#d8cbbb", "#f4ebdc", "#402a16", "#a79f97"]
                }
            ];

            // Update planet scales based on current scale factor
            function updatePlanetScales() {
                for (let i = 0; i < planets.length; i++) {
                    const planet = planets[i];
                    planet.radius = planet.baseRadius * scale;
                    planet.distance = planet.baseDistance * scale;
                }
            }

            // Resize canvas when window is resized
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                // Update offscreen canvas and redraw orbit paths
                offscreenCanvas.width = canvas.width;
                offscreenCanvas.height = canvas.height;

                // Update center and scale
                centerX = canvas.width / 2;
                centerY = canvas.height / 2;
                scale = Math.min(canvas.width, canvas.height) / 90;

                // Update planet sizes and distances based on new scale
                updatePlanetScales();

                // Redraw orbit paths
                drawOrbitPaths();
            });

            // Draw orbit paths on the offscreen canvas
            function drawOrbitPaths() {
                offscreenCtx.clearRect(0, 0, offscreenCanvas.width, offscreenCanvas.height);
                offscreenCtx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                offscreenCtx.lineWidth = 1;

                for (let i = 1; i < planets.length; i++) {
                    const planet = planets[i];
                    offscreenCtx.beginPath();
                    offscreenCtx.arc(centerX, centerY, planet.distance, 0, Math.PI * 2);
                    offscreenCtx.stroke();
                }
            }

            // Draw a planet with pixel filling using 4 colors
            function drawPlanet(ctx, x, y, radius, colors, name) {
                // Create a pattern of 4 colors in a deterministic way
                ctx.save();

                // Fill the planet with base color
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fillStyle = colors[0];
                ctx.fill();

                // Add pixel-like effect with other colors
                const pixelSize = Math.max(1, radius / 10);

                // Use the planet name as a seed for deterministic color assignment
                const seed = name.charCodeAt(0) + name.length;

                for (let px = -radius; px < radius; px += pixelSize) {
                    for (let py = -radius; py < radius; py += pixelSize) {
                        // Check if point is inside circle
                        if (px * px + py * py <= radius * radius) {
                            // Deterministic color selection based on position and planet name
                            const hash = Math.abs(Math.sin(px * 0.5 + py * 0.3 + seed) * 10000) % 3;
                            const colorIndex = 1 + Math.floor(hash); // index 1-3

                            ctx.fillStyle = colors[colorIndex];
                            ctx.fillRect(x + px, y + py, pixelSize, pixelSize);
                        }
                    }
                }

                ctx.restore();
            }

            // Draw planet label that always faces the camera
            function drawLabel(ctx, x, y, radius, name) {
                ctx.save();
                ctx.font = `${Math.max(12, radius / 2)}px Arial`;
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.fillText(name, x, y + radius + 20);
                ctx.restore();
            }

            // Draw rounded rectangle for counters
            function roundedRect(ctx, x, y, width, height, radius) {
                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + width - radius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                ctx.lineTo(x + width, y + height - radius);
                ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                ctx.lineTo(x + radius, y + height);
                ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                ctx.lineTo(x, y + radius);
                ctx.quadraticCurveTo(x, y, x + radius, y);
                ctx.closePath();
            }

            // Draw FPS counter and day counter
            let fps = 0;
            let framesCount = 0;
            let totalFrames = 0;
            let lastFpsUpdate = 0;
            let avgFps = 0;
            let earthDays = 0;

            function drawCounters() {
                ctx.save();

                // Background
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                roundedRect(ctx, 10, 10, 200, 70, 10);
                ctx.fill();

                // Text
                ctx.fillStyle = 'black';
                ctx.font = '16px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`FPS: ${fps}`, 20, 30);
                ctx.fillText(`AVG FPS: ${avgFps.toFixed(1)}`, 20, 50);
                ctx.fillText(`Earth Day: ${Math.floor(earthDays)}`, 20, 70);

                ctx.restore();
            }

            // Setup Web Worker for position calculations
            const positionWorker = new Worker(URL.createObjectURL(new Blob([`
                // Position calculation worker
                
                self.onmessage = function(e) {
                    const { planets, timeDelta } = e.data;
                    
                    // Calculate new positions
                    for (let i = 1; i < planets.length; i++) {
                        const planet = planets[i];
                        // Convert time delta from milliseconds to days (1 sec = 10 earth days)
                        const daysElapsed = (timeDelta / 1000) * 10;
                        
                        // Calculate new angle based on orbit period
                        planet.angle += (2 * Math.PI / planet.orbitPeriod) * daysElapsed;
                        if (planet.angle > 2 * Math.PI) {
                            planet.angle -= 2 * Math.PI;
                        }
                    }
                    
                    self.postMessage({ planets, daysElapsed });
                };
            `], { type: 'application/javascript' })));

            // Animation variables
            let lastTime = 0;
            let animationId;

            // Position worker message handler
            positionWorker.onmessage = function (e) {
                const { planets: updatedPlanets, daysElapsed } = e.data;

                // Update planet positions
                for (let i = 1; i < planets.length; i++) {
                    planets[i].angle = updatedPlanets[i].angle;
                }

                // Update earth days counter
                earthDays += daysElapsed;
            };

            // Main animation loop
            function animate(timestamp) {
                if (!lastTime) {
                    lastTime = timestamp;
                    animationId = requestAnimationFrame(animate);
                    return;
                }

                const timeDelta = timestamp - lastTime;
                lastTime = timestamp;

                // Calculate FPS
                framesCount++;
                totalFrames++;

                if (timestamp - lastFpsUpdate > 1000) {
                    fps = Math.round(framesCount * 1000 / (timestamp - lastFpsUpdate));
                    avgFps = totalFrames * 1000 / timestamp;
                    framesCount = 0;
                    lastFpsUpdate = timestamp;
                }

                // Send data to web worker for position calculations
                positionWorker.postMessage({ planets, timeDelta });

                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw orbit paths from offscreen canvas
                ctx.drawImage(offscreenCanvas, 0, 0);

                // Draw planets
                for (let i = 0; i < planets.length; i++) {
                    const planet = planets[i];

                    // Calculate position
                    let x, y;
                    if (i === 0) {
                        // Sun is at the center
                        x = centerX;
                        y = centerY;
                    } else {
                        // Planet orbits around sun
                        x = centerX + planet.distance * Math.cos(planet.angle);
                        y = centerY + planet.distance * Math.sin(planet.angle);
                    }

                    // Draw planet
                    drawPlanet(ctx, x, y, planet.radius, planet.colors, planet.name);

                    // Draw label
                    drawLabel(ctx, x, y, planet.radius, planet.name);
                }

                // Draw counters
                drawCounters();

                // Continue animation loop
                animationId = requestAnimationFrame(animate);
            }

            // Initialize
            drawOrbitPaths();
            animationId = requestAnimationFrame(animate);

        })();
    </script>
</body>

</html>
